public class MillerRabin {
    private static BigInteger TWO = new BigInteger(2);
    public static boolean millerRabin(BigInteger p, int k) {
	Random rnd = new Random(0); // always seed with a known value for testing
	
	BigInteger pminus1 = p.subtract(BigInteger.ONE);
	// find out how many trailing zeros there are in p-1
	int r = pminus1.getLowestSetBit(); // r is the number of zero bits
	BigInteger d = pminus1.shiftRight(r);
	for (int i = 0; i < k; ++i) {
	    BigInteger temp;
	    BigInteger a;
	    do {   //if < 3 we have a problem
		temp = new BigInteger(pminus1.bitCount()+ 10, rnd);
		a = temp.mod(pminus1);
	    } while (a.compareTo(TWO));
	    // 1 < a < p-2
	    // compute a^d mod p
	    BigInteger x = a.modPow(d, p);
	    if (x.compareTo(BigInteger.ONE) == 0 || x.compareTo(pminus1) == 0)
		continue;
	    for (--r ; r > 0; --r) {
              

	    }
	}
        return true;

    }
